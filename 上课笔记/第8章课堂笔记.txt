1.阿里
  叮叮 - 协同编辑
  语雀

  字节
   飞书 

 办公- 大的趋势  


 2.粒度（颗粒度）

 细粒度-微服务设计

 粗粒度-单体结构


3.版本

文件系统中：

同一个文件，多个版本（限制版本数量）

版本1
版本2
版本3
版本4--改坏了

版本的回滚

4.不同文件版本储存的是变化值（delta）么？
不是的
是完整的文件信息

5.文件读取时的uuid也是前端渲染的时候产生的吗？如果是的话，后端的数据结构就是在前端渲染以后才产生的， 对吗？
 文件系统-》内存 —〉客户客户端，渲染。-》行号对应的 
 ->内存 -〉 转换成文件 -》文件系统

 1  A
 2  B
 2-1 D
 3  C




6.前端渲染的时候生成uuid,那么后端application server 这个时候内存链表不存在key吗？
  文件-》文件系统，只存储文件本身的内容


7.那如果uid是根据前端的渲染产生的，那前端resize窗口不是也会导致后端数据结构的改变？
   不是根据窗口大小改变，有一个固定的标准 
   根据文本内容划分行

8.采用行锁的方式，用户体验差一些，但是不出语句不通顺的问题，同一个时刻只能有一个人修改

   无锁的方式，OT，虽然能够解决多人同时编辑一行的问，引入一个语意的问题，导致语句不通畅
   


   南帝：我要去买西瓜
   江畔：我要去买哈密瓜

   我要去买哈密西瓜


   两种方式有利有弊，不同的产品会有自己的权衡

   9.能不能请老师详细讲一下34页如何在redis里存file和file的每一行的？定时任务是如何使用34页这个信息来合并修改的呢


    Key: file key + row key


    1分种，合并一次
    10:00-10:01 对应的redis中文件的操作找出来

    
file key + row key   A，B，C
 

 生成一个新的文件内容 =》 文件系统中去


这里的ROW KEY是UUID么？ 是的
那还是要存UUID
只是存在内存中


9.dummy 和tail是分别存什么

头和尾

链表 最后一行后面插入
如果记录尾在哪里，

A-》B-〉

10.多个前端生成的uuid重了怎么办？
uuid不会重复

11.row key由前端生成，怎么在不同clients之间同步文件操作？


第一次加载
内存，

第一个client A 文档打开的时候，就把前段渲染的uuid,保存到服务器的内存
 1  A
 2  B
 3  C


第二个client B 

1  A
2  B
3  C

  
12.redis需要储存一份完整的带链表的文件吗
不需要
在服务端已经存储一个完整
redis只存储修改的内容


13.websocket怎么scale， 百人同时在线?
直播，ZOOM
并发量大，分布式


14.OT算法是在两个request几乎同时来的时候才会使用吗？服务器端是如何判断这个时候需要使用OT算法呢？
时间戳
判断各个客户端的状态

根据不同的状态，不同的命令

15.还是不太明白什么是web socket。 web socket怎么使用呢？
   
  客户端 和服务端通信的一个应用，
   可以理解为部署了一个系统
16.异步任务是一次把Redis中所有的数据都读出来合并然后更新？Redis中也要带个TTL限制数据量，是吧？定时任务cadence要比TTL小才能保证不丢更新是吧？
读取固定时间内的命令

19.請問粒度改成詞是不是可以解決這些問題
粒度改成词，也会存在问题

20.服务端内存存的话 是不是需要所有client都连接到同一个server呀？

  分布式
  文件的Key路由，会放在多个机器上，这几个机器上的这个文件内容是同步
  不是放在单台的，是多台，冗余备份

21.UUID在第一个客户端加载时候会发到Web Server，对吧？都编辑万之后，UUID怎么同步到File Server中去整合并写入File System？

不写入的

文件系统，只存储最终的文件内容

22.不是用linked hash map? 可以透過key查到每一行不需要遍厲吧?
hash
linekedList

 插入最后一行的后面
   
hash，是快速读取值
key;value

还是需要在redis中存储尾节点


23.两用户同时在同一位置更改为不同字符怎么处理？
OT 后面的会覆盖掉

ABC

1:ABB
2:ABD

24.所有的文件协同编辑系统都是用websocket吗？有用http的吗
http也可以实现
目前都是websocket 

25.老师讲一下撤销吧
?
ctr z各种之前的edit

ABC
AB
反做
update


26.能简单讲一下词粒度的实现吗？
有锁
a apple a day
中文中有 分词器（自然语言处理）
tokinizer


27.插中间和插最后为啥不一样呢(为啥插最后就需要tail)？前端插了某一行不是应该就给了前后id给后端了吗，为啥需要tail，还是不懂

A B C
最后一个位置，需要遍历的时间长

数组：
10
a[10]

链表需要遍历

28.所以定时任务要知道UUID对么？
需要的

29.定时任务就是WebServer中的一个Thread


30.可以再加一个hash来存节点
可以
Hash,存储地址，存储值

31.定时就用Quartz之类的service就行了
很多定时任务框架


32. 上课时间
美西时间 2月19日晚上 18：30
北京时间 2月20日 上午 10：30

