1.单品券
2.商户圈
3.类目

4.UMP 营销中台


5.
flexible rule太多了
serialization
种类太多了 需要灵活点吧我感觉
好处是可拓展
灵活 rule
将来好改


6.特别重视MQ的使用
MQ面试中非常高频的问题
优点，能解决什么问题
什么场景下需要使用
Kakfa RocketMQ. rabbitMQ

7.通过MQ

异步 削峰填谷

8.
bloomfilter  布隆过滤器 Redis 
锁库存
鎖?
redis
库存预热？

9.老师，缓存预热如何导致  超高并发放行呢

1万个券 满100减99
 
 10000 1S内被用户抢完了
 1S 1万个请求到了 Mysql,发券
 1万请求 -》MQ -〉再去消费
 和秒杀抢购一样的


10.Follow up一个问题：那 MOM（Message oriented Middleware)和MQ（Message Queue）的区别是什么呀？
消息中间件 消息队列
同一个东西
中间件（消息队列，Redis，等）

11.json格式的validation是怎么实现的呢？比如不能parse的field或者不合理的数据（比如负的价格）

Java 中 Json 转换成对象
写很多对json中规则的验证

校验写之前做吧，写入必合理
写入，最好double check



12.mysql也可以做sharding吧？为啥1w个就会被打挂
单机情况下，mysql QPS 1000

1000个


13.Redis
在涉及到并发量大的情况下，同时对应数据库的读写
考虑使用Redis,不能直接去读写Mysql数据库
缓存
 单机  （4核 8G）
 Redis  10W
 mysql  1000
 读写的性能
Redis 就是为这种大数据量 高并发而生的


14.订单系统不是一直有参与吗？前面是说第一步只有卷系统参与

订单系统是一直参与
交易业务的串联

15.面试中要讲这么细吗?
TCC概念要理解

16.多个券规则之间冲突的校验怎么实现比较好？规则里面那么多种细节
 
 互斥的

 券的类型，满减，满折，现金抵扣券

17.券表可以按时间分区存储吗？这样查询时只需查询相对应分区？
分库分表
时间分区不断增多
userId  分区


18.优惠卷提醒 优惠卷新表扫描，如果用户已经注销但是仍有未使用优惠劵的情况如何处理？
会去校验用户的状态

19.TCC在server down断电 OOM这种情况下还好用不
咱们设计系统的时候 要不要考虑server断电 OOM的时候 当时正在处理的那个request怎么补偿？

补偿机制
冻结超过48H，会自动解冻
每一次操作都有操作的记录，再扫描这些记录，发起补偿


（那48小时之内，用户重新登陆，是不是就不能用这个券了？）

解冻券都要通过订单系统吗？会不会出现券被解冻了，订单还有效的情况？
解冻券，把订单关闭，解冻




付款，还可以用

20.想請問即使用了tcc是不是還是會有同時查詢優惠劵但還沒有凍結的情況，造成返回其實己凍結的優惠券的情形?
不会的
即使出现这种情况，我提交订单的时候也会校验的

21.优惠券提醒一般什么频率比较好？
10张券，都是同一天过期的，还有2天没有使用发短信

22.如果商家叫停券的使用怎么办，直接更新有效期？
100减50

拼多多 出了bug 100.1-100 （不讲武德）
直接删
23.发短信的cost 是怎么样的？ 这样的成本需要考虑吗或者收如何衡量？
短信接口运营商

24.每个表里存什么内容这个需要记吗？怎么记比较好？面试会问怎么样设计表吗？
不需要
重点的点

25.rate limiting有什么现成的solution吗，还是要自己写
sentinel

26.秒杀系统里 order system也是类似的串联角色吗
也可以这样理解
实际工作中是，交易系统
 商品页-》购物车-〉交易-》订单系统-〉支付系统  -》退款系统
 商品中心 营销系统 限购系统 库存系统

27.TCC在咱们这个case下 是哪个service负责协调？估计coupon operation table也是归那个service负责的吧

try 
confirm
cancle 
优惠券系统中的
优惠券服务


28.什么数据进入缓存，就是类似lru cache那种，程序员不需要制定哪些进入缓存，由redis负责，对吗？

把数据放到redis缓存中，会设置超时时间的
redis,LRU 
主动删除，惰性删除


29.如果10张券是不同批次，碰巧同一天过期，还是会收到10条短信，对吗？
是的

30.如果一个coupon可以用三次 coupon table需要怎么改呢 coupon table里状态和timestamp这些都需要调整
券都只能用一次
商家一次性发3个coupon ，三个不同的记录

31.coupon id什么的就auto increment就行了吗，还是说uuid之类的
自动就可以了 分库分表，所以不行
DB1 DB2 ，重复
分布式唯一ID
雪花算法，推特的使用的算法，学习一下

32. 为了准备面试 应该至少熟悉哪些nosql和消息中间件呢 cache肯定是需要懂redis了
mysql redis  MQ（kafka rockeckeMQ rabbitMQ）,最低标准

HDFS 限流 分库分表 sentienl 负载均衡 搜索引擎 日志 （会最好）





